# -*- coding: utf-8 -*-
"""techcluster.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1zSifYZFDpbkL94mqJ6zGBnfKFCXVVibQ
"""

import pandas as pd
import numpy as np

train=pd.read_csv("/content/train.csv")
test=pd.read_csv("/content/test.csv")
test_ids=test["PassengerId"]

train.info()

#to check the fields which have null values 
train.isnull().sum()

#defining a function to clean data
def clean(train):
  train=train.drop(['Name','PassengerId','Ticket','Cabin'],axis=1)
  train['Age'].fillna(train['Age'].mean(), inplace=True)
  train['Embarked'].fillna(train['Embarked'].mode()[0],inplace=True)
  train.replace({'Sex':{'male':0,'female':1}, 'Embarked':{'S':0,'C':1,'Q':2}}, inplace=True)
  return train

train=clean(train)
test=clean(test)

train.head()

train.info()

def model(train):
  from sklearn.linear_model import LogisticRegression
  from sklearn.model_selection import train_test_split
  X=train.drop("Survived",axis=1)
  Y=train['Survived']

  X_train, X_val, Y_train, Y_val = train_test_split(X,Y, test_size=0.2, random_state=2)
  clf=LogisticRegression(random_state=0,max_iter=1000).fit(X_train,Y_train)
  predictions=clf.predict(X_val)
  from sklearn.metrics import accuracy_score
  ans=accuracy_score(Y_val,predictions)
  return ans

train_model=model(train)
print(train_model)

test.isnull().sum()

test['Fare'].fillna(train['Fare'].mean(), inplace=True)

test.isnull().sum()

check=clf.predict(test)

#creating a new dataframe to test the model
testdf=pd.DataFrame({"PassengerId":test_ids.values,"Survived":check})

#converting dataframe to excel sheet 
testdf.to_csv("Final.csv",index=False)

